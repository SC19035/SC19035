<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Yingli" />

<meta name="date" content="2020-01-02" />

<title>Introduction to SC19035</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Introduction to SC19035</h1>
<h4 class="author">Yingli</h4>
<h4 class="date">2020-01-02</h4>



<div id="the-introduction-of-two-function" class="section level1">
<h1>The introduction of two function</h1>
<p><strong>SC19035</strong> is a simple R package developed to two function for the ‘Statistical Computing’ course. The first function is called <em>mytable</em>,which is to build a contingency table of the counts at each combination of factor levels with two objects.And the other function ,namely <em>Numerical integration</em> , is prepared to deal with numerical integration with integrate using R.</p>
<div id="mytable" class="section level2">
<h2><em>mytable</em></h2>
<p>The source R code for <em>mytable</em> is as follows:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1">mytable &lt;-<span class="cf">function</span>(x,y){</a>
<a class="sourceLine" id="cb1-2" title="2">  x=<span class="kw">as.factor</span>(x)</a>
<a class="sourceLine" id="cb1-3" title="3">  y=<span class="kw">as.factor</span>(y)</a>
<a class="sourceLine" id="cb1-4" title="4">  xi=<span class="kw">as.integer</span>(x)</a>
<a class="sourceLine" id="cb1-5" title="5">  xm=<span class="kw">as.integer</span>(<span class="kw">max</span>(xi))</a>
<a class="sourceLine" id="cb1-6" title="6">  yi=(<span class="kw">as.integer</span>(y)<span class="op">-</span>1L)<span class="op">*</span>xm</a>
<a class="sourceLine" id="cb1-7" title="7">  ym=<span class="kw">as.integer</span>(<span class="kw">max</span>(yi)<span class="op">+</span>xm)</a>
<a class="sourceLine" id="cb1-8" title="8">  <span class="kw">matrix</span>(<span class="kw">.Internal</span>(<span class="kw">tabulate</span>(xi<span class="op">+</span>yi,ym)),xm)</a>
<a class="sourceLine" id="cb1-9" title="9">}</a></code></pre></div>
<p>The source R code for <em>Numerical integration</em> is as follows:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">cdf &lt;-<span class="st"> </span><span class="cf">function</span>(x,p,q) {</a>
<a class="sourceLine" id="cb2-2" title="2">  n&lt;-<span class="kw">length</span>(x)</a>
<a class="sourceLine" id="cb2-3" title="3">  res&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb2-4" title="4">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</a>
<a class="sourceLine" id="cb2-5" title="5">    res[i]&lt;-<span class="kw">integrate</span>(f, <span class="dt">lower=</span><span class="op">-</span><span class="ot">Inf</span>, <span class="dt">upper=</span>x[i],</a>
<a class="sourceLine" id="cb2-6" title="6">                      <span class="dt">rel.tol=</span>.Machine<span class="op">$</span>double.eps<span class="op">^</span><span class="fl">0.25</span>,</a>
<a class="sourceLine" id="cb2-7" title="7">                      <span class="dt">p=</span>p,<span class="dt">q=</span>q)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb2-8" title="8">  }</a>
<a class="sourceLine" id="cb2-9" title="9">  <span class="kw">return</span>(res)</a>
<a class="sourceLine" id="cb2-10" title="10">}</a></code></pre></div>
</div>
</div>
<div id="homework" class="section level1">
<h1>Homework</h1>
</div>
<div id="hw020190920" class="section level1">
<h1>HW0(2019/09/20)</h1>
<p>Use knitr to produce at least 3 example(texts, tables and figures). ## Answer ## text</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw">paste</span>(<span class="st">&quot;R&quot;</span>,<span class="st">&quot;for Beginning&quot;</span>)</a></code></pre></div>
<pre><code>## [1] &quot;R for Beginning&quot;</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw">paste</span>(<span class="st">&quot;Today is&quot;</span>,<span class="kw">date</span>())</a></code></pre></div>
<pre><code>## [1] &quot;Today is Thu Jan 02 20:03:12 2020&quot;</code></pre>
<p>We can use the function paste() to concatenate its variables into a string separated by spaces.</p>
<div id="figures" class="section level2">
<h2>figures</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">A&lt;-<span class="kw">array</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">9</span>,<span class="dt">dim=</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb7-2" title="2">B&lt;-<span class="kw">array</span>(<span class="dv">9</span><span class="op">:</span><span class="dv">1</span>,<span class="dt">dim=</span>(<span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>)))</a>
<a class="sourceLine" id="cb7-3" title="3">C&lt;-A<span class="op">%*%</span>B;C</a></code></pre></div>
<pre><code>##      [,1] [,2] [,3]
## [1,]   90   54   18
## [2,]  114   69   24
## [3,]  138   84   30</code></pre>
<p>A%*%B represents the product of two matrices</p>
</div>
<div id="tables" class="section level2">
<h2>tables</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">X1&lt;-<span class="kw">c</span>(<span class="dv">35</span>,<span class="dv">42</span>,<span class="dv">46</span>,<span class="dv">37</span>,<span class="dv">38</span>,<span class="dv">42</span>,<span class="dv">41</span>)</a>
<a class="sourceLine" id="cb9-2" title="2">X2&lt;-<span class="kw">c</span>(<span class="dv">60</span>,<span class="dv">72</span>,<span class="dv">64</span>,<span class="dv">62</span>,<span class="dv">71</span>,<span class="dv">69</span>,<span class="dv">75</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"><span class="kw">plot</span>(X1,X2)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="kw">hist</span>(X1)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> X1represent the weight and X2 is the waist circumference of the students, we draw their scatter plot first, and then draw the histogram of the weight.</p>
</div>
</div>
<div id="hw120190929" class="section level1">
<h1>HW1(2019/09/29)</h1>
<div id="question1exercise3-4" class="section level2">
<h2>Question1(Exercise3-4)</h2>
<p>Answer: ### 1.Develop an algorithm to generate the function that satisify Rayleigh(σ) distribution.Suppose sigma=4.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">rrayleigh&lt;-<span class="cf">function</span>(n,sigma){</a>
<a class="sourceLine" id="cb11-2" title="2">  sigma&lt;-<span class="dv">1</span><span class="op">:</span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb11-3" title="3">  u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb11-4" title="4">  x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">**</span>{<span class="dv">2</span>}<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb11-5" title="5">  <span class="kw">return</span> (x)</a>
<a class="sourceLine" id="cb11-6" title="6">}</a>
<a class="sourceLine" id="cb11-7" title="7"></a>
<a class="sourceLine" id="cb11-8" title="8">n1&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb11-9" title="9">sigma1&lt;-<span class="dv">4</span></a>
<a class="sourceLine" id="cb11-10" title="10">rr=<span class="kw">head</span>(<span class="kw">rrayleigh</span>(n1,sigma1),<span class="dv">10</span>)</a>
<a class="sourceLine" id="cb11-11" title="11"><span class="kw">hist</span>(<span class="kw">rrayleigh</span>(n1,sigma1),<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ### 2.Suppose sigma=10.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb12-2" title="2">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb12-3" title="3">sigma&lt;-<span class="dv">10</span></a>
<a class="sourceLine" id="cb12-4" title="4">x&lt;-<span class="kw">sqrt</span>(<span class="op">-</span><span class="dv">2</span><span class="op">*</span>sigma<span class="op">**</span>{<span class="dv">2</span>}<span class="op">*</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u))</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw">hist</span>(x,<span class="dt">prob=</span><span class="ot">TRUE</span>,<span class="dt">main =</span> <span class="kw">expression</span>(<span class="kw">f</span>(x)<span class="op">==</span>x<span class="op">/</span>(sigma<span class="op">**</span><span class="dv">2</span>)<span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>((x<span class="op">/</span>sigma)<span class="op">**</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">2</span>)))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question2exercise3-11" class="section level2">
<h2>Question2(Exercise3-11)</h2>
</div>
<div id="answer" class="section level2">
<h2>Answer：</h2>
<div id="generate-a-sample-from-a-mixture.-suppose-the-p10.75" class="section level3">
<h3>1.Generate a sample from a mixture. Suppose the p1=0.75</h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">n&lt;-<span class="dv">1000</span></a>
<a class="sourceLine" id="cb13-2" title="2">x1&lt;-<span class="kw">rnorm</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-3" title="3">x2&lt;-<span class="kw">rnorm</span>(n,<span class="dv">3</span>,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb13-4" title="4">u&lt;-<span class="kw">runif</span>(n)</a>
<a class="sourceLine" id="cb13-5" title="5">p&lt;-<span class="kw">as.integer</span>(u<span class="op">&gt;</span><span class="fl">0.25</span>)</a>
<a class="sourceLine" id="cb13-6" title="6">x&lt;-p<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>p)<span class="op">*</span>x2 <span class="co">##the mixture</span></a></code></pre></div>
</div>
<div id="graph-the-histogram-of-the-sample-withdensity-superimposed-for-p1-0.75." class="section level3">
<h3>2.Graph the histogram of the sample withdensity superimposed, for p1 = 0.75.</h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">hist</span>(x, <span class="dt">prob =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> ### 3.Repeat with different values</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1">q1&lt;-<span class="kw">as.integer</span>(u<span class="op">&gt;</span><span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb15-2" title="2">y1&lt;-q1<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>q1)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb15-3" title="3"><span class="kw">hist</span>(y1,<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">q2&lt;-<span class="kw">as.integer</span>(u<span class="op">&gt;</span><span class="fl">0.42</span>)</a>
<a class="sourceLine" id="cb16-2" title="2">y2&lt;-q2<span class="op">*</span>x1<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>q2)<span class="op">*</span>x2</a>
<a class="sourceLine" id="cb16-3" title="3"><span class="kw">hist</span>(y2,<span class="dt">prob=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --> From the above pictures, the empirical distribution of the mixture doesn’t appear to bebimodal.</p>
</div>
</div>
<div id="question-3exercise3-11" class="section level2">
<h2>Question 3(Exercise3-11)</h2>
<p>Write a function to generate a random sample from a Wd(Σ, n) (Wishart)distribution for n&gt;d + 1 ≥ 1,based on Bartlett’s decomposition. ### 1.Based on Bartlett’s decomposition,generate a function</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">require</span>(graphics)</a>
<a class="sourceLine" id="cb17-2" title="2">runif.wis&lt;-<span class="cf">function</span>(sigma,n){</a>
<a class="sourceLine" id="cb17-3" title="3">  a&lt;-<span class="kw">ncol</span>(sigma)</a>
<a class="sourceLine" id="cb17-4" title="4">  b&lt;-<span class="kw">chol</span>(sigma)</a>
<a class="sourceLine" id="cb17-5" title="5">  X&lt;-<span class="kw">matrix</span>(<span class="dt">ncol=</span>a,<span class="dt">chol=</span>a)</a>
<a class="sourceLine" id="cb17-6" title="6">  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>a){</a>
<a class="sourceLine" id="cb17-7" title="7">    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>a){</a>
<a class="sourceLine" id="cb17-8" title="8">      X[i,j]=<span class="kw">rnorm</span>(<span class="dv">2</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb17-9" title="9">    }</a>
<a class="sourceLine" id="cb17-10" title="10">  }</a>
<a class="sourceLine" id="cb17-11" title="11"> X[<span class="kw">lower.tri</span>(X)]=<span class="dv">0</span></a>
<a class="sourceLine" id="cb17-12" title="12"> C&lt;-<span class="kw">numeric</span>(a)</a>
<a class="sourceLine" id="cb17-13" title="13"> <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>a){</a>
<a class="sourceLine" id="cb17-14" title="14"> C[i]=<span class="kw">rchisq</span>(<span class="dv">1</span>,n<span class="op">-</span>i<span class="op">+</span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb17-15" title="15">  X[i,i]=C[i]</a>
<a class="sourceLine" id="cb17-16" title="16"> }</a>
<a class="sourceLine" id="cb17-17" title="17">  d&lt;-b<span class="op">%*%</span>X</a>
<a class="sourceLine" id="cb17-18" title="18">  e&lt;-<span class="kw">t</span>(X)<span class="op">%*%</span><span class="kw">t</span>(b)</a>
<a class="sourceLine" id="cb17-19" title="19">  f&lt;-d<span class="op">%*%</span>e</a>
<a class="sourceLine" id="cb17-20" title="20"> <span class="kw">return</span>(f)</a>
<a class="sourceLine" id="cb17-21" title="21">}</a></code></pre></div>
</div>
</div>
<div id="hw220191011" class="section level1">
<h1>HW2(2019/10/11)</h1>
<div id="question-1exercise-5.1" class="section level2">
<h2>Question 1(Exercise 5.1)</h2>
<p>Compute a Monte Carlo estimate of <span class="math display">\[\int_0^{π/3}sint{\rm d}t\]</span></p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer</h2>
<p><span class="math display">\[\int_0^{π/3}sint{\rm d}t=(π/3)\int_0^{1}sin(3x/π){\rm d}x\]</span> ### estimate</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb18-2" title="2">x &lt;-<span class="st"> </span><span class="kw">runif</span>(m)</a>
<a class="sourceLine" id="cb18-3" title="3">theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">sin</span>(pi<span class="op">/</span><span class="dv">3</span><span class="op">*</span>x)) <span class="op">*</span><span class="st"> </span>(pi<span class="op">/</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb18-4" title="4"><span class="kw">print</span>(theta.hat)</a></code></pre></div>
<pre><code>## [1] 0.5026985</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" title="1"><span class="kw">print</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>))</a></code></pre></div>
<pre><code>## [1] 0.5</code></pre>
</div>
<div id="question-2exercise-5.10" class="section level2">
<h2>Question 2(Exercise 5.10)</h2>
<p>Use Monte Carlo integration with antithetic variables to estimate <span class="math display">\[\int_0^1\frac{e^{-x}}{1+x^2}{\rm d}x\]</span> and find the approximate reduction in variance as a percentage of the variance without variance reduction.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" title="1"><span class="co">## the definition of function</span></a>
<a class="sourceLine" id="cb22-2" title="2">MC.Phi &lt;-<span class="st"> </span><span class="cf">function</span>(x, <span class="dt">R =</span> <span class="dv">10000</span>, <span class="dt">antithetic =</span> <span class="ot">TRUE</span>) {</a>
<a class="sourceLine" id="cb22-3" title="3">u &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb22-4" title="4"><span class="cf">if</span> (<span class="op">!</span>antithetic) v &lt;-<span class="st"> </span><span class="kw">runif</span>(R<span class="op">/</span><span class="dv">2</span>) <span class="cf">else</span></a>
<a class="sourceLine" id="cb22-5" title="5">v &lt;-<span class="st"> </span><span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u</a>
<a class="sourceLine" id="cb22-6" title="6">u &lt;-<span class="st"> </span><span class="kw">c</span>(u, v)</a>
<a class="sourceLine" id="cb22-7" title="7">cdf &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">length</span>(x))</a>
<a class="sourceLine" id="cb22-8" title="8"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="kw">length</span>(x)) {</a>
<a class="sourceLine" id="cb22-9" title="9">g &lt;-<span class="kw">mean</span>(<span class="kw">exp</span>(<span class="op">-</span>u <span class="op">*</span><span class="st"> </span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>(u<span class="op">*</span>x)<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb22-10" title="10">}</a>
<a class="sourceLine" id="cb22-11" title="11">g</a>
<a class="sourceLine" id="cb22-12" title="12">}</a>
<a class="sourceLine" id="cb22-13" title="13"><span class="co">## Use Monte Carlo integration with antithetic variables to estimate</span></a>
<a class="sourceLine" id="cb22-14" title="14"><span class="kw">set.seed</span>(<span class="dv">200</span>)</a>
<a class="sourceLine" id="cb22-15" title="15">MC1&lt;-<span class="kw">MC.Phi</span>(<span class="dv">1</span>,<span class="dt">anti=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb22-16" title="16">MC2&lt;-<span class="kw">MC.Phi</span>(<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb22-17" title="17"><span class="kw">print</span>(MC1)</a></code></pre></div>
<pre><code>## [1] 0.5230898</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" title="1"><span class="kw">print</span>(MC2)</a></code></pre></div>
<pre><code>## [1] 0.5248264</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1"><span class="co">## find the approximate reduction in variance</span></a>
<a class="sourceLine" id="cb26-2" title="2">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb26-3" title="3">MC1 &lt;-<span class="st"> </span>MC2&lt;-<span class="kw">numeric</span>(m)</a>
<a class="sourceLine" id="cb26-4" title="4">x&lt;-<span class="dv">1</span></a>
<a class="sourceLine" id="cb26-5" title="5"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {</a>
<a class="sourceLine" id="cb26-6" title="6">MC1[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dt">R =</span> <span class="dv">1000</span>, <span class="dt">anti =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb26-7" title="7">MC2[i] &lt;-<span class="st"> </span><span class="kw">MC.Phi</span>(x,<span class="dt">R =</span> <span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb26-8" title="8">}</a>
<a class="sourceLine" id="cb26-9" title="9"> <span class="kw">print</span>(<span class="kw">sd</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.007831286</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1"> <span class="kw">print</span>(<span class="kw">sd</span>(MC2))</a></code></pre></div>
<pre><code>## [1] 0.001502095</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1"> <span class="kw">print</span>((<span class="kw">var</span>(MC1)<span class="op">-</span><span class="kw">var</span>(MC2))<span class="op">/</span><span class="kw">var</span>(MC1))</a></code></pre></div>
<pre><code>## [1] 0.9632101</code></pre>
</div>
<div id="question-3exercise-5.15" class="section level2">
<h2>Question 3(Exercise 5.15)</h2>
</div>
<div id="answer-3" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" title="1">m &lt;-<span class="st"> </span><span class="dv">10000</span></a>
<a class="sourceLine" id="cb32-2" title="2">theta.hat &lt;-<span class="st"> </span>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb32-3" title="3">g &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb32-4" title="4"><span class="kw">exp</span>(<span class="op">-</span>x <span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)) <span class="op">*</span><span class="st"> </span>(x <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>) <span class="op">*</span><span class="st"> </span>(x <span class="op">&lt;</span><span class="st"> </span><span class="dv">1</span>)</a>
<a class="sourceLine" id="cb32-5" title="5">}</a>
<a class="sourceLine" id="cb32-6" title="6"><span class="co"># choose the importance function : f3=exp（-x）/(1+exp（-1）)</span></a>
<a class="sourceLine" id="cb32-7" title="7">u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) <span class="co">#f3, inverse transform method</span></a>
<a class="sourceLine" id="cb32-8" title="8">x &lt;-<span class="st"> </span><span class="op">-</span><span class="st"> </span><span class="kw">log</span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>u <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb32-9" title="9">fg&lt;-<span class="st"> </span><span class="cf">function</span>(x){ <span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</a>
<a class="sourceLine" id="cb32-10" title="10">}</a>
<a class="sourceLine" id="cb32-11" title="11"><span class="co">#stratify</span></a>
<a class="sourceLine" id="cb32-12" title="12">M &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates</span></a>
<a class="sourceLine" id="cb32-13" title="13">k &lt;-<span class="st"> </span><span class="dv">5</span> <span class="co">#number of strata</span></a>
<a class="sourceLine" id="cb32-14" title="14">r &lt;-<span class="st"> </span>M <span class="op">/</span><span class="st"> </span>k <span class="co">#replicates per stratum</span></a>
<a class="sourceLine" id="cb32-15" title="15">N &lt;-<span class="st"> </span><span class="dv">50</span> <span class="co">#number of times to repeat the estimation</span></a>
<a class="sourceLine" id="cb32-16" title="16">T2 &lt;-<span class="st"> </span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb32-17" title="17">estimates &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb32-18" title="18"><span class="co"># estimate</span></a>
<a class="sourceLine" id="cb32-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</a>
<a class="sourceLine" id="cb32-20" title="20">estimates[i, <span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">runif</span>(M)))</a>
<a class="sourceLine" id="cb32-21" title="21"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k)</a>
<a class="sourceLine" id="cb32-22" title="22">T2[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">fg</span>(<span class="kw">runif</span>(M<span class="op">/</span>k, (j<span class="dv">-1</span>)<span class="op">/</span>k, j<span class="op">/</span>k)))</a>
<a class="sourceLine" id="cb32-23" title="23">estimates[i, <span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(T2)</a>
<a class="sourceLine" id="cb32-24" title="24">}</a>
<a class="sourceLine" id="cb32-25" title="25"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, mean)</a></code></pre></div>
<pre><code>## [1] 0.4961869 0.4964806</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1"><span class="kw">apply</span>(estimates, <span class="dv">2</span>, var)</a></code></pre></div>
<pre><code>## [1] 8.017591e-07 3.318758e-08</code></pre>
</div>
</div>
<div id="hw320191101" class="section level1">
<h1>HW3(2019/11/01)</h1>
<div id="question-1exercises-6.7" class="section level2">
<h2>Question 1(Exercises 6.7)</h2>
<p>Estimate the power of the skewness test of normality against symmetric Beta(α,α) distributions and comment on the results. Are the results diﬀerent for heavy-tailed symmetric alternatives such as t(ν)? ## Answer <span class="math display">\[Beta(α,α)=\int_0^{1}t^{α-1}(1-t)^{α-1}{\rm d}t\]</span></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">alpha &lt;-<span class="st"> </span><span class="fl">.5</span> </a>
<a class="sourceLine" id="cb36-2" title="2">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb36-3" title="3">m &lt;-<span class="st"> </span><span class="dv">1000</span> </a>
<a class="sourceLine" id="cb36-4" title="4">beta&lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>, <span class="dv">40</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb36-5" title="5">N &lt;-<span class="st"> </span><span class="kw">length</span>(beta) </a>
<a class="sourceLine" id="cb36-6" title="6">pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) </a>
<a class="sourceLine" id="cb36-7" title="7">cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))<span class="co">#critical value for the skewness test </span></a>
<a class="sourceLine" id="cb36-8" title="8"></a>
<a class="sourceLine" id="cb36-9" title="9"></a>
<a class="sourceLine" id="cb36-10" title="10">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x) { <span class="co">#computes the sample skewness coeff. </span></a>
<a class="sourceLine" id="cb36-11" title="11">  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb36-12" title="12">  m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>) </a>
<a class="sourceLine" id="cb36-13" title="13">  m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb36-14" title="14">  <span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> ) </a>
<a class="sourceLine" id="cb36-15" title="15">  } </a>
<a class="sourceLine" id="cb36-16" title="16"></a>
<a class="sourceLine" id="cb36-17" title="17"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each beta </span></a>
<a class="sourceLine" id="cb36-18" title="18">  b&lt;-<span class="st"> </span>beta[j] </a>
<a class="sourceLine" id="cb36-19" title="19">  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) </a>
<a class="sourceLine" id="cb36-20" title="20">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { <span class="co">#for each replicate </span></a>
<a class="sourceLine" id="cb36-21" title="21">    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,b,b)</a>
<a class="sourceLine" id="cb36-22" title="22">    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">sk</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv) </a>
<a class="sourceLine" id="cb36-23" title="23">    } </a>
<a class="sourceLine" id="cb36-24" title="24">  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) } <span class="co">#plot power vs beta </span></a>
<a class="sourceLine" id="cb36-25" title="25"></a>
<a class="sourceLine" id="cb36-26" title="26"></a>
<a class="sourceLine" id="cb36-27" title="27"><span class="kw">plot</span>(beta, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">xlab =</span> <span class="kw">bquote</span>(beta), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="fl">0.3</span>,<span class="fl">0.5</span>))</a>
<a class="sourceLine" id="cb36-28" title="28"><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb36-29" title="29">se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span>pwr) <span class="op">/</span><span class="st"> </span>m) <span class="co">#add standard errors </span></a>
<a class="sourceLine" id="cb36-30" title="30"><span class="kw">lines</span>(beta, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb36-31" title="31"><span class="kw">lines</span>(beta, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2exercises-6.a" class="section level2">
<h2>Question 2(Exercises 6.A)</h2>
<p>Use Monte Carlo simulation to investigate whether the empirical Type I error rate of the t-test is approximately equal to the nominal signiﬁcance level α, when the sampled population is non-normal. The t-test is robust to mild departures from normality. Discuss the simulation results for the cases where the sampled population is (i) χ2(1), (ii) Uniform(0,2), and (iii) Exponential(rate=1). In each case, test H0 : µ = µ0 vs H0 : µ= µ0, where µ0 is the mean of χ2(1), Uniform(0,2), and Exponential(1), respectively. ## Answer Suppose the nominal signiﬁcance level α=0.05 ### 2.1 χ2(1)</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb37-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.01</span> </a>
<a class="sourceLine" id="cb37-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb37-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb37-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb37-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb37-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb37-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb37-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb37-10" title="10">  }</a>
<a class="sourceLine" id="cb37-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb37-12" title="12">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m) </a>
<a class="sourceLine" id="cb37-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.00040000 0.00019996</code></pre>
<p>The empirical Type I error rate of the t-test isn’t approximately equal to the nominal signiﬁcance level α, when the sampled population is χ2(1). ### 2.2 Uniform(0,2)</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb39-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.01</span> </a>
<a class="sourceLine" id="cb39-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb39-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb39-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb39-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb39-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb39-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb39-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb39-10" title="10">  }</a>
<a class="sourceLine" id="cb39-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb39-12" title="12">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m) </a>
<a class="sourceLine" id="cb39-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.011200000 0.001052357</code></pre>
<p>The empirical Type I error rate of the t-test is approximately equal to the nominal signiﬁcance level α, when the sampled population is Uniform(0,2).</p>
<div id="exponentialrate1" class="section level3">
<h3>2.3 Exponential(rate=1)</h3>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">n &lt;-<span class="st"> </span><span class="dv">20</span> </a>
<a class="sourceLine" id="cb41-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">.01</span> </a>
<a class="sourceLine" id="cb41-3" title="3">mu0 &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb41-4" title="4">m &lt;-<span class="st"> </span><span class="dv">10000</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb41-5" title="5">p &lt;-<span class="st"> </span><span class="kw">numeric</span>(m) <span class="co">#storage for p-values </span></a>
<a class="sourceLine" id="cb41-6" title="6"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) { </a>
<a class="sourceLine" id="cb41-7" title="7">  x &lt;-<span class="st"> </span><span class="kw">rexp</span>(n,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb41-8" title="8">  ttest &lt;-<span class="st"> </span><span class="kw">t.test</span>(x, <span class="dt">alternative =</span> <span class="st">&quot;greater&quot;</span>, <span class="dt">mu =</span> mu0) </a>
<a class="sourceLine" id="cb41-9" title="9">  p[j] &lt;-<span class="st"> </span>ttest<span class="op">$</span>p.value </a>
<a class="sourceLine" id="cb41-10" title="10">  }</a>
<a class="sourceLine" id="cb41-11" title="11">p.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(p <span class="op">&lt;</span><span class="st"> </span>alpha) </a>
<a class="sourceLine" id="cb41-12" title="12">se.hat &lt;-<span class="st"> </span><span class="kw">sqrt</span>(p.hat <span class="op">*</span><span class="st"> </span>(<span class="dv">1</span> <span class="op">-</span><span class="st"> </span>p.hat) <span class="op">/</span><span class="st"> </span>m) </a>
<a class="sourceLine" id="cb41-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(p.hat, se.hat))</a></code></pre></div>
<pre><code>## [1] 0.0014000000 0.0003739037</code></pre>
<p>The empirical Type I error rate of the t-test isn’t approximately equal to the nominal signiﬁcance level α, when the sampled population is Exponential(rate=1).</p>
</div>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>If we obtain the powers for two methods under a particularsimulation setting with 10,000 experiments: say, 0.651 for onemethod and 0.676 for another method. Can we say the powersare different at 0.05 level? 3.1 What is the corresponding hypothesis test problem? 3.2 What test should we use? Z-test, two-sample t-test, paired-ttest or McNemar test? 3.3 What information is needed to test your hypothesis? ## Answer we can say the powersare different at 0.05 level. ### Answer 3.1 The corresponding hypothesis test problem is: H0:F(x)∈N,i.e N is the distribution of the method 1. ### Answer 3.2 we should use paired-ttest for its larger df. ### Answer 3.3 We need to know how many times that H0 is rejected or the number of P values &lt; α # HW4(2019/11/08) ## Question 1(7.6) ## Answer ### the scatter diagram</p>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"> <span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb43-2" title="2"><span class="kw">data</span>(scor)</a>
<a class="sourceLine" id="cb43-3" title="3"><span class="kw">pairs</span>(scor[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>], <span class="dt">main =</span> <span class="st">&quot;the scatter diagram &quot;</span>,<span class="dt">bg =</span> <span class="kw">c</span>(<span class="st">&quot;red&quot;</span>, <span class="st">&quot;green&quot;</span>, <span class="st">&quot;blue&quot;</span>,<span class="st">&quot;yellow&quot;</span>,<span class="st">&quot;black&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div id="compare" class="section level3">
<h3>Compare</h3>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="kw">library</span>(<span class="st">&#39;GGally&#39;</span>)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：ggplot2</code></pre>
<pre><code>## Registered S3 method overwritten by &#39;GGally&#39;:
##   method from   
##   +.gg   ggplot2</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1836</span>)</a>
<a class="sourceLine" id="cb47-2" title="2">sc &lt;-<span class="st"> </span>scor[,<span class="kw">c</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>)]</a>
<a class="sourceLine" id="cb47-3" title="3"><span class="kw">ggpairs</span>(sc[<span class="kw">sample.int</span>(<span class="kw">nrow</span>(sc),<span class="dv">20</span>),])</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" title="1"><span class="co"># Estimate standard error</span></a>
<a class="sourceLine" id="cb48-2" title="2"><span class="co">#set up the bootstrap </span></a>
<a class="sourceLine" id="cb48-3" title="3">B &lt;-<span class="st"> </span><span class="dv">100</span> <span class="co">#number of replicates </span></a>
<a class="sourceLine" id="cb48-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor) <span class="co">#sample size </span></a>
<a class="sourceLine" id="cb48-5" title="5">R12 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B) <span class="co">#storage for replicates</span></a>
<a class="sourceLine" id="cb48-6" title="6"><span class="co">#bootstrap estimate of standard error of R </span></a>
<a class="sourceLine" id="cb48-7" title="7"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb48-8" title="8">        i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb48-9" title="9">        MEC &lt;-<span class="st"> </span>scor<span class="op">$</span>mec[i] <span class="co">#i is a vector of indices </span></a>
<a class="sourceLine" id="cb48-10" title="10">        VEC &lt;-<span class="st"> </span>scor<span class="op">$</span>vec[i] </a>
<a class="sourceLine" id="cb48-11" title="11">        R12[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(MEC, VEC) </a>
<a class="sourceLine" id="cb48-12" title="12"> } </a>
<a class="sourceLine" id="cb48-13" title="13"><span class="kw">print</span>(se.R12 &lt;-<span class="st"> </span><span class="kw">sd</span>(R12))</a></code></pre></div>
<pre><code>## [1] 0.08039764</code></pre>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">B &lt;-<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb50-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)  </a>
<a class="sourceLine" id="cb50-3" title="3">R34 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)  </a>
<a class="sourceLine" id="cb50-4" title="4"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb50-5" title="5">        i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb50-6" title="6">        ALG &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i] </a>
<a class="sourceLine" id="cb50-7" title="7">        ANA &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i] </a>
<a class="sourceLine" id="cb50-8" title="8">        R34[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ALG, ANA) </a>
<a class="sourceLine" id="cb50-9" title="9"> } </a>
<a class="sourceLine" id="cb50-10" title="10"><span class="kw">print</span>(se.R34 &lt;-<span class="st"> </span><span class="kw">sd</span>(R34))</a></code></pre></div>
<pre><code>## [1] 0.04457367</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" title="1">B &lt;-<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb52-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)  </a>
<a class="sourceLine" id="cb52-3" title="3">R35 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)  </a>
<a class="sourceLine" id="cb52-4" title="4"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb52-5" title="5">        i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb52-6" title="6">        ALG &lt;-<span class="st"> </span>scor<span class="op">$</span>alg[i] </a>
<a class="sourceLine" id="cb52-7" title="7">        STA &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i] </a>
<a class="sourceLine" id="cb52-8" title="8">        R35[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ALG, STA) </a>
<a class="sourceLine" id="cb52-9" title="9"> } </a>
<a class="sourceLine" id="cb52-10" title="10"><span class="kw">print</span>(se.R35 &lt;-<span class="st"> </span><span class="kw">sd</span>(R35))</a></code></pre></div>
<pre><code>## [1] 0.06020861</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1">B &lt;-<span class="st"> </span><span class="dv">100</span> </a>
<a class="sourceLine" id="cb54-2" title="2">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)  </a>
<a class="sourceLine" id="cb54-3" title="3">R45 &lt;-<span class="st"> </span><span class="kw">numeric</span>(B)  </a>
<a class="sourceLine" id="cb54-4" title="4"><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>B) { </a>
<a class="sourceLine" id="cb54-5" title="5">        i &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n, <span class="dt">replace =</span> <span class="ot">TRUE</span>) </a>
<a class="sourceLine" id="cb54-6" title="6">        ANA &lt;-<span class="st"> </span>scor<span class="op">$</span>ana[i] </a>
<a class="sourceLine" id="cb54-7" title="7">        STA &lt;-<span class="st"> </span>scor<span class="op">$</span>sta[i] </a>
<a class="sourceLine" id="cb54-8" title="8">        R45[b] &lt;-<span class="st"> </span><span class="kw">cor</span>(ANA, STA) </a>
<a class="sourceLine" id="cb54-9" title="9"> } </a>
<a class="sourceLine" id="cb54-10" title="10"><span class="kw">print</span>(se.R45 &lt;-<span class="st"> </span><span class="kw">sd</span>(R45))</a></code></pre></div>
<pre><code>## [1] 0.06440646</code></pre>
</div>
</div>
<div id="question-27.b" class="section level2">
<h2>Question 2(7.B)</h2>
</div>
<div id="answer-4" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb56-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb56-3" title="3">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb56-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n, <span class="dv">0</span>, <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb56-5" title="5"></a>
<a class="sourceLine" id="cb56-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb56-7" title="7">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb56-8" title="8">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb56-9" title="9">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb56-10" title="10"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb56-11" title="11">}</a>
<a class="sourceLine" id="cb56-12" title="12"></a>
<a class="sourceLine" id="cb56-13" title="13">m&lt;-<span class="dv">50</span>     </a>
<a class="sourceLine" id="cb56-14" title="14"><span class="co"># sample size</span></a>
<a class="sourceLine" id="cb56-15" title="15">norm1_cil&lt;-norm1_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb56-16" title="16">basic1_cil&lt;-basic1_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb56-17" title="17">perc1_cil&lt;-perc1_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb56-18" title="18"><span class="co"># Monte Carlo and bootstrap</span></a>
<a class="sourceLine" id="cb56-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb56-20" title="20">  x&lt;-<span class="kw">rnorm</span>(m)</a>
<a class="sourceLine" id="cb56-21" title="21">  boot.obj&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb56-22" title="22">  ci&lt;-<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;perc&#39;</span>))</a>
<a class="sourceLine" id="cb56-23" title="23">  norm1_cil[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">2</span>]</a>
<a class="sourceLine" id="cb56-24" title="24">  norm1_cir[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb56-25" title="25">  basic1_cil[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb56-26" title="26">  basic1_cir[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb56-27" title="27">  perc1_cil[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">4</span>]</a>
<a class="sourceLine" id="cb56-28" title="28">  perc1_cir[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">5</span>]</a>
<a class="sourceLine" id="cb56-29" title="29">}</a>
<a class="sourceLine" id="cb56-30" title="30"><span class="co"># compute coverage rates </span></a>
<a class="sourceLine" id="cb56-31" title="31"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>((norm1_cil<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">*</span>(norm1_cir<span class="op">&gt;</span><span class="dv">0</span>)),<span class="kw">mean</span>((basic1_cil<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">*</span>(basic1_cir<span class="op">&gt;</span><span class="dv">0</span>)),</a>
<a class="sourceLine" id="cb56-32" title="32">        <span class="kw">mean</span>((perc1_cil<span class="op">&lt;</span><span class="dv">0</span>)<span class="op">*</span>(perc1_cir<span class="op">&gt;</span><span class="dv">0</span>))))</a></code></pre></div>
<pre><code>## [1] 0.91 0.89 0.96</code></pre>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb58-1" title="1"><span class="kw">set.seed</span>(<span class="dv">1111</span>)</a>
<a class="sourceLine" id="cb58-2" title="2"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb58-3" title="3">n &lt;-<span class="st"> </span><span class="dv">100</span></a>
<a class="sourceLine" id="cb58-4" title="4">x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n, <span class="dv">0</span>, <span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-5" title="5"></a>
<a class="sourceLine" id="cb58-6" title="6">sk &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) {</a>
<a class="sourceLine" id="cb58-7" title="7">xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x[i])</a>
<a class="sourceLine" id="cb58-8" title="8">m3 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">3</span>)</a>
<a class="sourceLine" id="cb58-9" title="9">m2 &lt;-<span class="st"> </span><span class="kw">mean</span>((x[i] <span class="op">-</span><span class="st"> </span>xbar)<span class="op">^</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb58-10" title="10"><span class="kw">return</span>( m3 <span class="op">/</span><span class="st"> </span>m2<span class="op">^</span><span class="fl">1.5</span> )</a>
<a class="sourceLine" id="cb58-11" title="11">}</a>
<a class="sourceLine" id="cb58-12" title="12"></a>
<a class="sourceLine" id="cb58-13" title="13">m&lt;-<span class="dv">50</span>     </a>
<a class="sourceLine" id="cb58-14" title="14"><span class="co"># sample size</span></a>
<a class="sourceLine" id="cb58-15" title="15">norm2_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb58-16" title="16">basic2_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb58-17" title="17">perc2_cir&lt;-<span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb58-18" title="18"><span class="co"># Monte Carlo and bootstrap</span></a>
<a class="sourceLine" id="cb58-19" title="19"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb58-20" title="20">  x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(n,<span class="dv">5</span>)</a>
<a class="sourceLine" id="cb58-21" title="21">  boot.obj&lt;-<span class="kw">boot</span>(x,<span class="dt">statistic=</span>sk,<span class="dt">R=</span><span class="dv">2000</span>)</a>
<a class="sourceLine" id="cb58-22" title="22">  ci&lt;-<span class="kw">boot.ci</span>(boot.obj,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&#39;norm&#39;</span>,<span class="st">&#39;basic&#39;</span>,<span class="st">&#39;perc&#39;</span>))</a>
<a class="sourceLine" id="cb58-23" title="23">  norm2_cir[i]&lt;-ci<span class="op">$</span>normal[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb58-24" title="24">  basic2_cir[i]&lt;-ci<span class="op">$</span>basic[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb58-25" title="25">  perc2_cir[i]&lt;-ci<span class="op">$</span>percent[<span class="dv">3</span>]</a>
<a class="sourceLine" id="cb58-26" title="26">}</a>
<a class="sourceLine" id="cb58-27" title="27"><span class="co"># compute coverage rates </span></a>
<a class="sourceLine" id="cb58-28" title="28"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(norm2_cir<span class="op">&gt;</span><span class="dv">0</span>),<span class="kw">mean</span>(basic2_cir<span class="op">&gt;</span><span class="dv">0</span>),</a>
<a class="sourceLine" id="cb58-29" title="29">        <span class="kw">mean</span>(perc2_cir<span class="op">&gt;</span><span class="dv">0</span>)))</a></code></pre></div>
<pre><code>## [1] 1 1 1</code></pre>
</div>
</div>
<div id="hw520191115" class="section level1">
<h1>HW5(2019/11/15)</h1>
<div id="exercise-7.8" class="section level2">
<h2>Exercise 7.8</h2>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb60-1" title="1"><span class="kw">library</span>(bootstrap)</a>
<a class="sourceLine" id="cb60-2" title="2"><span class="kw">data</span>(scor)</a>
<a class="sourceLine" id="cb60-3" title="3">scor_pca &lt;-<span class="st"> </span><span class="kw">princomp</span>(scor, <span class="dt">cor =</span> F)</a>
<a class="sourceLine" id="cb60-4" title="4"><span class="kw">print</span>(scor_pca )</a></code></pre></div>
<pre><code>## Call:
## princomp(x = scor, cor = F)
## 
## Standard deviations:
##    Comp.1    Comp.2    Comp.3    Comp.4    Comp.5 
## 26.061142 14.135571 10.127604  9.147061  5.638077 
## 
##  5  variables and  88 observations.</code></pre>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb62-1" title="1">theta.hat &lt;-<span class="st"> </span><span class="fl">0.619115</span><span class="co">#the proportion of variance explained by the first principal component is 0.619115</span></a>
<a class="sourceLine" id="cb62-2" title="2"></a>
<a class="sourceLine" id="cb62-3" title="3"><span class="co">#jackknife</span></a>
<a class="sourceLine" id="cb62-4" title="4">n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</a>
<a class="sourceLine" id="cb62-5" title="5">theta.hat.j &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb62-6" title="6"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</a>
<a class="sourceLine" id="cb62-7" title="7">scor_j &lt;-<span class="st"> </span>scor[<span class="op">-</span>i, ]</a>
<a class="sourceLine" id="cb62-8" title="8">scor_j_cov &lt;-<span class="st"> </span><span class="kw">cov</span>(scor_j)</a>
<a class="sourceLine" id="cb62-9" title="9">theta.hat.j[i] &lt;-<span class="kw">eigen</span>(scor_j_cov)<span class="op">$</span>value[<span class="dv">1</span>] <span class="op">/</span><span class="st"> </span><span class="kw">sum</span>(<span class="kw">eigen</span>(scor_j_cov)<span class="op">$</span>value)</a>
<a class="sourceLine" id="cb62-10" title="10">}</a>
<a class="sourceLine" id="cb62-11" title="11"></a>
<a class="sourceLine" id="cb62-12" title="12"><span class="co">#bias</span></a>
<a class="sourceLine" id="cb62-13" title="13">bias &lt;-<span class="st"> </span>(n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span>(<span class="kw">mean</span>(theta.hat.j) <span class="op">-</span><span class="st"> </span>theta.hat)</a>
<a class="sourceLine" id="cb62-14" title="14"><span class="kw">print</span>(bias)</a></code></pre></div>
<pre><code>## [1] 0.001072482</code></pre>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb64-1" title="1"><span class="co">#standard error</span></a>
<a class="sourceLine" id="cb64-2" title="2">se &lt;-<span class="kw">sqrt</span>((n <span class="op">-</span><span class="st"> </span><span class="dv">1</span>) <span class="op">*</span><span class="st"> </span><span class="kw">mean</span>((theta.hat.j <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(theta.hat.j)) <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb64-3" title="3"><span class="kw">print</span>(se)</a></code></pre></div>
<pre><code>## [1] 0.04955231</code></pre>
</div>
<div id="exercise-7.10" class="section level2">
<h2>Exercise 7.10</h2>
</div>
<div id="answer-6" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb66-1" title="1"><span class="kw">library</span>(DAAG)</a></code></pre></div>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb70-1" title="1"><span class="kw">attach</span>(ironslag)</a>
<a class="sourceLine" id="cb70-2" title="2"></a>
<a class="sourceLine" id="cb70-3" title="3">L1 &lt;-<span class="st">  </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb70-4" title="4">L2 &lt;-<span class="st">  </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical <span class="op">^</span><span class="st"> </span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb70-5" title="5">L3 &lt;-<span class="st">  </span><span class="kw">lm</span>(<span class="kw">log</span>(magnetic) <span class="op">~</span><span class="st"> </span>chemical)</a>
<a class="sourceLine" id="cb70-6" title="6">L4 &lt;-<span class="st">  </span><span class="kw">lm</span>(magnetic <span class="op">~</span><span class="st"> </span>chemical <span class="op">+</span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(chemical<span class="op">^</span><span class="dv">3</span>)) <span class="co"># replacing the Log-Log model with a cubic polynomial model</span></a>
<a class="sourceLine" id="cb70-7" title="7"></a>
<a class="sourceLine" id="cb70-8" title="8">n &lt;-<span class="st"> </span><span class="kw">length</span>(ironslag<span class="op">$</span>magnetic) <span class="co">#in DAAG ironslag </span></a>
<a class="sourceLine" id="cb70-9" title="9">e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</a>
<a class="sourceLine" id="cb70-10" title="10"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) { </a>
<a class="sourceLine" id="cb70-11" title="11">  y &lt;-<span class="st"> </span>magnetic[<span class="op">-</span>k] </a>
<a class="sourceLine" id="cb70-12" title="12">  x &lt;-<span class="st"> </span>chemical[<span class="op">-</span>k]</a>
<a class="sourceLine" id="cb70-13" title="13">  </a>
<a class="sourceLine" id="cb70-14" title="14">  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb70-15" title="15">  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb70-16" title="16">  e1[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat1</a>
<a class="sourceLine" id="cb70-17" title="17"></a>
<a class="sourceLine" id="cb70-18" title="18">  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)) </a>
<a class="sourceLine" id="cb70-19" title="19">  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">^</span><span class="dv">2</span> </a>
<a class="sourceLine" id="cb70-20" title="20">  e2[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat2</a>
<a class="sourceLine" id="cb70-21" title="21"></a>
<a class="sourceLine" id="cb70-22" title="22">  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x) </a>
<a class="sourceLine" id="cb70-23" title="23">  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k] </a>
<a class="sourceLine" id="cb70-24" title="24">  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3) </a>
<a class="sourceLine" id="cb70-25" title="25">  e3[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat3</a>
<a class="sourceLine" id="cb70-26" title="26"></a>
<a class="sourceLine" id="cb70-27" title="27">  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>)<span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">3</span>)) </a>
<a class="sourceLine" id="cb70-28" title="28">  yhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>chemical[k]<span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">3</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">2</span>  <span class="op">+</span>J4<span class="op">$</span>coef[<span class="dv">4</span>]<span class="op">*</span>chemical[k]<span class="op">^</span><span class="dv">3</span></a>
<a class="sourceLine" id="cb70-29" title="29">  e4[k] &lt;-<span class="st"> </span>magnetic[k] <span class="op">-</span><span class="st"> </span>yhat4</a>
<a class="sourceLine" id="cb70-30" title="30">} </a>
<a class="sourceLine" id="cb70-31" title="31"><span class="kw">print</span>(<span class="kw">c</span>(<span class="kw">mean</span>(e1<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e2<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e3<span class="op">^</span><span class="dv">2</span>), <span class="kw">mean</span>(e4<span class="op">^</span><span class="dv">2</span>)))</a></code></pre></div>
<pre><code>## [1] 19.55644 17.85248 18.44188 18.17756</code></pre>
<p>According to the average error,We can say that the second model is the best among these models.</p>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb72-1" title="1"><span class="kw">print</span>(J1)<span class="co">#Y=1.7881+0.8895X</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Coefficients:
## (Intercept)            x  
##      1.7881       0.8895</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb74-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(J1))<span class="co">#Multiple R-squared is 0.5411</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -9.5784 -2.3022 -0.0203  2.1964 11.9740 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)   1.7881     2.5077   0.713    0.479    
## x             0.8895     0.1159   7.678 5.25e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 4.188 on 50 degrees of freedom
## Multiple R-squared:  0.5411, Adjusted R-squared:  0.5319 
## F-statistic: 58.95 on 1 and 50 DF,  p-value: 5.249e-10</code></pre>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb76-1" title="1"><span class="kw">print</span>(J2)<span class="co">#Y=25.98525-1.52948*X+0.05707*X^2</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Coefficients:
## (Intercept)            x       I(x^2)  
##    25.98525     -1.52948      0.05707</code></pre>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb78-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(J2))<span class="co">#Multiple R-squared is 0.607</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.2243 -2.4454 -0.1374  2.2346 12.5821 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)   
## (Intercept) 25.98525    8.75932   2.967  0.00464 **
## x           -1.52948    0.85065  -1.798  0.07834 . 
## I(x^2)       0.05707    0.01991   2.867  0.00609 **
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 3.915 on 49 degrees of freedom
## Multiple R-squared:  0.607,  Adjusted R-squared:  0.591 
## F-statistic: 37.84 on 2 and 49 DF,  p-value: 1.154e-10</code></pre>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb80-1" title="1"><span class="kw">print</span>(J3)<span class="co">#LOG(Y)=2.1274+0.04057*X</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(y) ~ x)
## 
## Coefficients:
## (Intercept)            x  
##     2.12740      0.04057</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb82-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(J3))<span class="co">#Multiple R-squared is 0.5307</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = log(y) ~ x)
## 
## Residuals:
##      Min       1Q   Median       3Q      Max 
## -0.63621 -0.08603 -0.00391  0.10665  0.44188 
## 
## Coefficients:
##             Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept) 2.127402   0.115186  18.469  &lt; 2e-16 ***
## x           0.040570   0.005321   7.624 6.37e-10 ***
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1
## 
## Residual standard error: 0.1924 on 50 degrees of freedom
## Multiple R-squared:  0.5376, Adjusted R-squared:  0.5283 
## F-statistic: 58.13 on 1 and 50 DF,  p-value: 6.371e-10</code></pre>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb84-1" title="1"><span class="kw">print</span>(J4)<span class="co">#Y=-2.7637+2.9084*X+(-0.1609)*X^2+0.0034*X^3</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Coefficients:
## (Intercept)            x       I(x^2)       I(x^3)  
##   -2.763718     2.908468    -0.160916     0.003424</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb86-1" title="1"><span class="kw">print</span>(<span class="kw">summary</span>(J4))<span class="co">#Multiple R-squared is 0.6176</span></a></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = y ~ x + I(x^2) + I(x^3))
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -8.4347 -2.0627 -0.3247  2.2127 13.1177 
## 
## Coefficients:
##              Estimate Std. Error t value Pr(&gt;|t|)
## (Intercept) -2.763718  26.402670  -0.105    0.917
## x            2.908468   3.938834   0.738    0.464
## I(x^2)      -0.160916   0.189976  -0.847    0.401
## I(x^3)       0.003424   0.002968   1.154    0.254
## 
## Residual standard error: 3.902 on 48 degrees of freedom
## Multiple R-squared:  0.6176, Adjusted R-squared:  0.5937 
## F-statistic: 25.84 on 3 and 48 DF,  p-value: 4.264e-10</code></pre>
<p>According to the R-squared,We can say that the third model is the best among these models. # HW6(2019/11/22) ## Question 1</p>
</div>
<div id="answer-7" class="section level2">
<h2>Answer</h2>
<p>When nx != ny, using m =5 as the critical value for both Cx and Cy may not be acceptable. We can ﬁnd an appropriate critical value for Cx by substituting different values of m=5 until we ﬁnd one resulting in aprobability that is approximately α/2. The formula is</p>
<p><span class="math display">\[P(Cx&gt;=m0/H0)=ln(nx/(nx+ny))*m\]</span></p>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb88-1" title="1">n1 &lt;-<span class="st"> </span><span class="dv">10</span></a>
<a class="sourceLine" id="cb88-2" title="2">n2 &lt;-<span class="st"> </span><span class="dv">20</span></a>
<a class="sourceLine" id="cb88-3" title="3">mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span> </a>
<a class="sourceLine" id="cb88-4" title="4">sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span> </a>
<a class="sourceLine" id="cb88-5" title="5">m &lt;-<span class="st"> </span><span class="dv">1000</span></a>
<a class="sourceLine" id="cb88-6" title="6"></a>
<a class="sourceLine" id="cb88-7" title="7"></a>
<a class="sourceLine" id="cb88-8" title="8"><span class="co">##Estimate the m</span></a>
<a class="sourceLine" id="cb88-9" title="9"></a>
<a class="sourceLine" id="cb88-10" title="10">alpha&lt;-<span class="fl">0.06</span></a>
<a class="sourceLine" id="cb88-11" title="11">mx&lt;-<span class="kw">log</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">log</span>(n1<span class="op">/</span>(n1<span class="op">+</span>n2))</a>
<a class="sourceLine" id="cb88-12" title="12">my&lt;-<span class="kw">log</span>(alpha<span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">log</span>(n2<span class="op">/</span>(n1<span class="op">+</span>n2))</a>
<a class="sourceLine" id="cb88-13" title="13"><span class="kw">print</span>(<span class="kw">c</span>(mx,my))<span class="co">#choose the bigger my </span></a></code></pre></div>
<pre><code>## [1] 3.191807 8.648236</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb90-1" title="1"><span class="co"># the critical value for both Cx,cy is m=8</span></a>
<a class="sourceLine" id="cb90-2" title="2">counttest &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb90-3" title="3">  X &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) </a>
<a class="sourceLine" id="cb90-4" title="4">  Y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb90-5" title="5">  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y)) </a>
<a class="sourceLine" id="cb90-6" title="6">  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X)) <span class="co"># return 1 (reject) or 0 (do not reject H0) </span></a>
<a class="sourceLine" id="cb90-7" title="7">  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)) <span class="op">&gt;</span><span class="st"> </span><span class="dv">8</span>)) </a>
<a class="sourceLine" id="cb90-8" title="8">  }</a>
<a class="sourceLine" id="cb90-9" title="9"></a>
<a class="sourceLine" id="cb90-10" title="10"></a>
<a class="sourceLine" id="cb90-11" title="11">tests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</a>
<a class="sourceLine" id="cb90-12" title="12">  x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1) </a>
<a class="sourceLine" id="cb90-13" title="13">  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2) </a>
<a class="sourceLine" id="cb90-14" title="14">  x &lt;-<span class="st"> </span>x <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(x) <span class="co">#centered by sample mean </span></a>
<a class="sourceLine" id="cb90-15" title="15">  y &lt;-<span class="st"> </span>y <span class="op">-</span><span class="st"> </span><span class="kw">mean</span>(y) </a>
<a class="sourceLine" id="cb90-16" title="16">  <span class="kw">counttest</span>(x, y) })</a>
<a class="sourceLine" id="cb90-17" title="17">alphahat &lt;-<span class="st"> </span><span class="kw">mean</span>(tests) </a>
<a class="sourceLine" id="cb90-18" title="18"><span class="kw">print</span>(alphahat) </a></code></pre></div>
<pre><code>## [1] 0.028</code></pre>
<p>In the simulation, each sample was centered by subtracting the sample mean, and the empirical Type I error rate was 0.036,which is under alpha(0.06).</p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>Power comparison (distance correlation test versus ball covariance test) Model1: Y =X/4+e Model2: Y =X/4×e X ∼ N(02, I2), e ∼ N(02, I2), X and e are independent. ## Answer</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb92-1" title="1"><span class="kw">library</span>(boot)</a>
<a class="sourceLine" id="cb92-2" title="2"><span class="kw">library</span>(Ball)</a>
<a class="sourceLine" id="cb92-3" title="3"><span class="kw">library</span>(MASS)</a></code></pre></div>
<pre><code>## 
## 载入程辑包：&#39;MASS&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:DAAG&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb95-1" title="1"><span class="kw">library</span>(ggplot2)</a>
<a class="sourceLine" id="cb95-2" title="2">alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></a>
<a class="sourceLine" id="cb95-3" title="3">n&lt;-<span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">1</span>,<span class="dv">100</span>,<span class="dv">5</span>))</a>
<a class="sourceLine" id="cb95-4" title="4">k&lt;-<span class="dv">50</span></a>
<a class="sourceLine" id="cb95-5" title="5"><span class="co">#denefite the statistic of cov,ndcov2</span></a>
<a class="sourceLine" id="cb95-6" title="6"></a>
<a class="sourceLine" id="cb95-7" title="7">dCov &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) { </a>
<a class="sourceLine" id="cb95-8" title="8">  x &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(x) </a>
<a class="sourceLine" id="cb95-9" title="9">  y &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(y) </a>
<a class="sourceLine" id="cb95-10" title="10">  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x) </a>
<a class="sourceLine" id="cb95-11" title="11">  m &lt;-<span class="st"> </span><span class="kw">nrow</span>(y) </a>
<a class="sourceLine" id="cb95-12" title="12">  <span class="cf">if</span> (n <span class="op">!=</span><span class="st"> </span>m <span class="op">||</span><span class="st"> </span>n <span class="op">&lt;</span><span class="st"> </span><span class="dv">2</span>) <span class="kw">stop</span>(<span class="st">&quot;Sample sizes must agree&quot;</span>) </a>
<a class="sourceLine" id="cb95-13" title="13">  <span class="cf">if</span> (<span class="op">!</span><span class="st"> </span>(<span class="kw">all</span>(<span class="kw">is.finite</span>(<span class="kw">c</span>(x, y))))) <span class="kw">stop</span>(<span class="st">&quot;Data contains missing or infinite values&quot;</span>)</a>
<a class="sourceLine" id="cb95-14" title="14">  </a>
<a class="sourceLine" id="cb95-15" title="15">  Akl &lt;-<span class="st"> </span><span class="cf">function</span>(x) {</a>
<a class="sourceLine" id="cb95-16" title="16">    d &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(<span class="kw">dist</span>(x)) </a>
<a class="sourceLine" id="cb95-17" title="17">    m &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(d) </a>
<a class="sourceLine" id="cb95-18" title="18">    M &lt;-<span class="st"> </span><span class="kw">mean</span>(d) </a>
<a class="sourceLine" id="cb95-19" title="19">    a &lt;-<span class="st"> </span><span class="kw">sweep</span>(d, <span class="dv">1</span>, m) </a>
<a class="sourceLine" id="cb95-20" title="20">    b &lt;-<span class="st"> </span><span class="kw">sweep</span>(a, <span class="dv">2</span>, m) </a>
<a class="sourceLine" id="cb95-21" title="21">    <span class="kw">return</span>(b <span class="op">+</span><span class="st"> </span>M) </a>
<a class="sourceLine" id="cb95-22" title="22">    } </a>
<a class="sourceLine" id="cb95-23" title="23">  A &lt;-<span class="st"> </span><span class="kw">Akl</span>(x) </a>
<a class="sourceLine" id="cb95-24" title="24">  B &lt;-<span class="st"> </span><span class="kw">Akl</span>(y) </a>
<a class="sourceLine" id="cb95-25" title="25">  dCov &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">mean</span>(A <span class="op">*</span><span class="st"> </span>B)) </a>
<a class="sourceLine" id="cb95-26" title="26">  dCov</a>
<a class="sourceLine" id="cb95-27" title="27">}</a>
<a class="sourceLine" id="cb95-28" title="28"></a>
<a class="sourceLine" id="cb95-29" title="29"></a>
<a class="sourceLine" id="cb95-30" title="30">ndCov2 &lt;-<span class="st"> </span><span class="cf">function</span>(z, ix, dims) { <span class="co">#dims contains dimensions of x and y </span></a>
<a class="sourceLine" id="cb95-31" title="31">  p &lt;-<span class="st"> </span>dims[<span class="dv">1</span>] </a>
<a class="sourceLine" id="cb95-32" title="32">  q &lt;-<span class="st"> </span>dims[<span class="dv">2</span>] </a>
<a class="sourceLine" id="cb95-33" title="33">  d &lt;-<span class="st"> </span>p <span class="op">+</span><span class="st"> </span>q </a>
<a class="sourceLine" id="cb95-34" title="34">  x &lt;-<span class="st"> </span>z[ , <span class="dv">1</span><span class="op">:</span>p] <span class="co">#leave x as is </span></a>
<a class="sourceLine" id="cb95-35" title="35">  y &lt;-<span class="st"> </span>z[ix, <span class="op">-</span>(<span class="dv">1</span><span class="op">:</span>p)] <span class="co">#permute rows of y </span></a>
<a class="sourceLine" id="cb95-36" title="36">  <span class="kw">return</span>(<span class="kw">nrow</span>(z) <span class="op">*</span><span class="st"> </span><span class="kw">dCov</span>(x, y)<span class="op">^</span><span class="dv">2</span>) </a>
<a class="sourceLine" id="cb95-37" title="37">  } </a>
<a class="sourceLine" id="cb95-38" title="38"></a>
<a class="sourceLine" id="cb95-39" title="39"></a>
<a class="sourceLine" id="cb95-40" title="40"><span class="kw">set.seed</span>(<span class="dv">1001</span>) </a>
<a class="sourceLine" id="cb95-41" title="41"></a>
<a class="sourceLine" id="cb95-42" title="42"></a>
<a class="sourceLine" id="cb95-43" title="43">pow_dCor_Model1&lt;-pow_ball_Model1&lt;-pow_dCor_Model2&lt;-pow_ball_Model2&lt;-<span class="kw">numeric</span>(<span class="kw">length</span>(n))</a>
<a class="sourceLine" id="cb95-44" title="44">dcor1&lt;-dcor2&lt;-p_ball1&lt;-p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb95-45" title="45"></a>
<a class="sourceLine" id="cb95-46" title="46"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb95-47" title="47">  dcor1 &lt;-p_ball1<span class="op">&lt;</span><span class="st"> </span><span class="op">-</span><span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb95-48" title="48">  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb95-49" title="49">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb95-50" title="50">    <span class="co"># the function &quot;rmvnorm&quot; is used to </span></a>
<a class="sourceLine" id="cb95-51" title="51">    <span class="co"># generate the multidimensional normal data</span></a>
<a class="sourceLine" id="cb95-52" title="52">    X&lt;-<span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-53" title="53">    e&lt;-<span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">1</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-54" title="54">    Y1&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">+</span>e</a>
<a class="sourceLine" id="cb95-55" title="55">    Z1&lt;-<span class="kw">cbind</span>(X,Y1)</a>
<a class="sourceLine" id="cb95-56" title="56">   </a>
<a class="sourceLine" id="cb95-57" title="57">     t1&lt;-<span class="kw">bcov.test</span>(X,Y1,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb95-58" title="58">    p_ball1[i]&lt;-t1<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb95-59" title="59">    boot.obj1&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z1,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">99</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb95-60" title="60">    temp1&lt;-<span class="kw">c</span>(boot.obj1<span class="op">$</span>t0, boot.obj1<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb95-61" title="61">    dcor1[i]&lt;-<span class="kw">mean</span>(temp1<span class="op">&gt;=</span>temp1[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb95-62" title="62">    }</a>
<a class="sourceLine" id="cb95-63" title="63">  pow_dCor_Model1[j]&lt;-<span class="kw">mean</span>(dcor1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb95-64" title="64">  pow_ball_Model1[j]&lt;-<span class="kw">mean</span>(p_ball1<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb95-65" title="65">}</a>
<a class="sourceLine" id="cb95-66" title="66">dat1&lt;-<span class="kw">data.frame</span>(pow_dCor_Model1,pow_ball_Model1)</a>
<a class="sourceLine" id="cb95-67" title="67"></a>
<a class="sourceLine" id="cb95-68" title="68"><span class="kw">ggplot</span>(dat1,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).</code></pre>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb98-1" title="1"><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(n)) {</a>
<a class="sourceLine" id="cb98-2" title="2">dcor2&lt;-<span class="st"> </span>p_ball2&lt;-<span class="kw">numeric</span>(k)</a>
<a class="sourceLine" id="cb98-3" title="3"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) {</a>
<a class="sourceLine" id="cb98-4" title="4">    <span class="kw">set.seed</span>(i)</a>
<a class="sourceLine" id="cb98-5" title="5">    <span class="co"># the function &quot;rmvnorm&quot; is used to </span></a>
<a class="sourceLine" id="cb98-6" title="6">    <span class="co"># generate the multidimensional normal data</span></a>
<a class="sourceLine" id="cb98-7" title="7">    X&lt;-<span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb98-8" title="8">    e&lt;-<span class="kw">mvrnorm</span>(n[j],<span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">2</span>),<span class="kw">diag</span>(<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb98-9" title="9">    Y2&lt;-(X<span class="op">/</span><span class="dv">4</span>)<span class="op">*</span>e</a>
<a class="sourceLine" id="cb98-10" title="10">    Z2&lt;-<span class="kw">cbind</span>(X,Y2)</a>
<a class="sourceLine" id="cb98-11" title="11">   </a>
<a class="sourceLine" id="cb98-12" title="12"> t2&lt;-<span class="kw">bcov.test</span>(X,Y2,<span class="dt">R=</span><span class="dv">99</span>)</a>
<a class="sourceLine" id="cb98-13" title="13">    p_ball2[i]&lt;-t2<span class="op">$</span>p.value</a>
<a class="sourceLine" id="cb98-14" title="14">    boot.obj2&lt;-<span class="kw">boot</span>(<span class="dt">data=</span>Z2,<span class="dt">statistic=</span>ndCov2,<span class="dt">R=</span><span class="dv">200</span>,<span class="dt">sim=</span><span class="st">&quot;permutation&quot;</span>,<span class="dt">dims=</span><span class="kw">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</a>
<a class="sourceLine" id="cb98-15" title="15">    temp2&lt;-<span class="kw">c</span>(boot.obj2<span class="op">$</span>t0, boot.obj2<span class="op">$</span>t)</a>
<a class="sourceLine" id="cb98-16" title="16">    dcor2[i]&lt;-<span class="kw">mean</span>(temp2<span class="op">&gt;=</span>temp2[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb98-17" title="17">}</a>
<a class="sourceLine" id="cb98-18" title="18">  pow_dCor_Model2[j]&lt;-<span class="kw">mean</span>(dcor2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb98-19" title="19">  pow_ball_Model2[j]&lt;-<span class="kw">mean</span>(p_ball2<span class="op">&lt;</span>alpha)</a>
<a class="sourceLine" id="cb98-20" title="20">  }</a>
<a class="sourceLine" id="cb98-21" title="21">dat2&lt;-<span class="kw">data.frame</span>(pow_dCor_Model2,pow_ball_Model2)</a>
<a class="sourceLine" id="cb98-22" title="22"></a>
<a class="sourceLine" id="cb98-23" title="23"></a>
<a class="sourceLine" id="cb98-24" title="24"><span class="kw">ggplot</span>(dat2,<span class="kw">aes</span>(n))<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_dCor_Model1,<span class="dt">colour=</span><span class="st">&quot;red&quot;</span>)<span class="op">+</span><span class="kw">geom_point</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">fill=</span><span class="st">&quot;white&quot;</span>)<span class="op">+</span><span class="kw">geom_line</span>(<span class="dt">y=</span>pow_ball_Model1,<span class="dt">colour=</span><span class="st">&quot;blue&quot;</span>)</a></code></pre></div>
<pre><code>## Warning: Removed 1 rows containing missing values (geom_point).

## Warning: Removed 1 rows containing missing values (geom_path).</code></pre>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw820191206" class="section level1">
<h1>HW8(2019/12/06)</h1>
<div id="questiion1" class="section level2">
<h2>Questiion1</h2>
</div>
<div id="answer-8" class="section level2">
<h2>Answer</h2>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb100-1" title="1">x&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb100-2" title="2"><span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span><span class="kw">exp</span>(<span class="kw">log</span>(x))</a></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb102-1" title="1"><span class="kw">exp</span>(<span class="kw">log</span>(x))<span class="op">==</span>x</a></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb104-1" title="1"><span class="kw">log</span>(<span class="kw">exp</span>(x))<span class="op">==</span>x</a></code></pre></div>
<pre><code>## [1]  TRUE  TRUE  TRUE  TRUE FALSE</code></pre>
<p>From the result,we can know that the property :log(expx) = exp(logx)=x does not hold exactly in computer arithmetic</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb106-1" title="1">x&lt;-<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">50</span>,<span class="dv">100</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb106-2" title="2"><span class="kw">isTRUE</span>(<span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)), x,<span class="kw">exp</span>(<span class="kw">log</span>(x)))) </a></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb108-1" title="1"><span class="kw">all.equal</span>(<span class="kw">log</span>(<span class="kw">exp</span>(x)),x,<span class="kw">exp</span>(<span class="kw">log</span>(x))) </a></code></pre></div>
<pre><code>## [1] &quot;Mean absolute difference: Inf&quot;</code></pre>
<p>According to the above, the identity doesn’t hold with near equality</p>
</div>
<div id="exercise-11.5" class="section level2">
<h2>Exercise 11.5</h2>
<p>Write a function to solve the equation <span class="math display">\[
\begin{aligned} \frac{2 \Gamma\left(\frac{k}{2}\right)}{\sqrt{\pi(k-1)} \Gamma\left(\frac{k-1}{2}\right)} \int_{0}^{c_{k-1}}\left(1+\frac{u^{2}}{k-1}\right)^{-k / 2} d u \\=&amp; \frac{2 \Gamma\left(\frac{k+1}{2}\right)}{\sqrt{\pi k} \Gamma\left(\frac{k}{2}\right)} \int_{0}^{c_{k}}\left(1+\frac{u^{2}}{k}\right)^{-(k+1) / 2} d u \\ \text { for } a, \text { where } &amp; \\ c_{k} &amp;=\sqrt{\frac{a^{2} k}{k+1-a^{2}}} \end{aligned}
\]</span> Compare the solutions with the points A(k) in Exercise 11.4.</p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb110-1" title="1"><span class="co">#11.5</span></a>
<a class="sourceLine" id="cb110-2" title="2"></a>
<a class="sourceLine" id="cb110-3" title="3">f =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb110-4" title="4"> </a>
<a class="sourceLine" id="cb110-5" title="5"> ck =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb110-6" title="6"> l1 =<span class="st"> </span><span class="kw">integrate</span>(<span class="cf">function</span>(u){(<span class="dv">1</span><span class="op">+</span>u<span class="op">^</span><span class="dv">2</span><span class="op">/</span>k)<span class="op">^</span>(<span class="op">-</span>(k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)},<span class="dv">0</span>,ck)<span class="op">$</span>value</a>
<a class="sourceLine" id="cb110-7" title="7"> l2 =<span class="st"> </span><span class="dv">2</span><span class="op">/</span><span class="kw">sqrt</span>(pi<span class="op">*</span>k)<span class="op">*</span><span class="kw">exp</span>(<span class="kw">lgamma</span>((k<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span><span class="dv">2</span>)<span class="op">-</span><span class="kw">lgamma</span>(k<span class="op">/</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb110-8" title="8"> l1<span class="op">*</span>l2</a>
<a class="sourceLine" id="cb110-9" title="9">}</a>
<a class="sourceLine" id="cb110-10" title="10"></a>
<a class="sourceLine" id="cb110-11" title="11">solve1 =<span class="st"> </span><span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb110-12" title="12">  </a>
<a class="sourceLine" id="cb110-13" title="13">  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">f</span>(a,k)<span class="op">-</span><span class="kw">f</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb110-14" title="14">  output<span class="op">$</span>root</a>
<a class="sourceLine" id="cb110-15" title="15">}</a>
<a class="sourceLine" id="cb110-16" title="16"></a>
<a class="sourceLine" id="cb110-17" title="17">k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span>,<span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</a>
<a class="sourceLine" id="cb110-18" title="18">root1 =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb110-19" title="19"></a>
<a class="sourceLine" id="cb110-20" title="20"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb110-21" title="21">  root1[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve1</span>(k[i]),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb110-22" title="22">}</a>
<a class="sourceLine" id="cb110-23" title="23"></a>
<a class="sourceLine" id="cb110-24" title="24">root1[<span class="dv">1</span>,] =<span class="st"> </span>k</a>
<a class="sourceLine" id="cb110-25" title="25"><span class="kw">rownames</span>(root1) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;root&#39;</span>)</a>
<a class="sourceLine" id="cb110-26" title="26">root1</a></code></pre></div>
<pre><code>##        [,1]    [,2]     [,3]     [,4]      [,5]
## k    4.0000 25.0000 100.0000 500.0000 1000.0000
## root 1.4921  1.6874   1.7206   1.7298    1.7309</code></pre>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb112-1" title="1"><span class="co">#11.4</span></a>
<a class="sourceLine" id="cb112-2" title="2"></a>
<a class="sourceLine" id="cb112-3" title="3">S =<span class="st"> </span><span class="cf">function</span>(a,k){</a>
<a class="sourceLine" id="cb112-4" title="4"> </a>
<a class="sourceLine" id="cb112-5" title="5"> ck =<span class="st"> </span><span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>))</a>
<a class="sourceLine" id="cb112-6" title="6"> <span class="kw">pt</span>(ck,<span class="dt">df=</span>k,<span class="dt">lower.tail=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb112-7" title="7">}</a>
<a class="sourceLine" id="cb112-8" title="8"></a>
<a class="sourceLine" id="cb112-9" title="9">solve2 =<span class="st"> </span><span class="cf">function</span>(k){</a>
<a class="sourceLine" id="cb112-10" title="10">  output =<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(a){<span class="kw">S</span>(a,k)<span class="op">-</span><span class="kw">S</span>(a,k<span class="dv">-1</span>)},<span class="dt">lower=</span><span class="dv">1</span>,<span class="dt">upper=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb112-11" title="11">  output<span class="op">$</span>root</a>
<a class="sourceLine" id="cb112-12" title="12">}</a>
<a class="sourceLine" id="cb112-13" title="13"></a>
<a class="sourceLine" id="cb112-14" title="14">root2 =<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="kw">length</span>(k))</a>
<a class="sourceLine" id="cb112-15" title="15"></a>
<a class="sourceLine" id="cb112-16" title="16"><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(k)){</a>
<a class="sourceLine" id="cb112-17" title="17">  root2[<span class="dv">2</span>,i]=<span class="kw">round</span>(<span class="kw">solve2</span>(k[i]),<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb112-18" title="18">}</a>
<a class="sourceLine" id="cb112-19" title="19"></a>
<a class="sourceLine" id="cb112-20" title="20">root2[<span class="dv">1</span>,] =<span class="st"> </span>k</a>
<a class="sourceLine" id="cb112-21" title="21"><span class="kw">rownames</span>(root2) =<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;k&#39;</span>,<span class="st">&#39;A(k)&#39;</span>)</a>
<a class="sourceLine" id="cb112-22" title="22">root2</a></code></pre></div>
<pre><code>##        [,1]    [,2]     [,3]     [,4]      [,5]
## k    4.0000 25.0000 100.0000 500.0000 1000.0000
## A(k) 1.4921  1.6874   1.7206   1.7298    1.7309</code></pre>
</div>
<div id="a-b-o-blood-type-problem" class="section level2">
<h2>A-B-O blood type problem</h2>
</div>
<div id="answer-9" class="section level2">
<h2>Answer</h2>
<p>Because of the observed data, we can rewrite the table as:</p>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">Frequency</th>
<th align="center">Count</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">AA</td>
<td align="center">p2</td>
<td align="center">nAA</td>
</tr>
<tr class="even">
<td align="center">BB</td>
<td align="center">q2</td>
<td align="center">nBB</td>
</tr>
<tr class="odd">
<td align="center">OO</td>
<td align="center">r2</td>
<td align="center">41</td>
</tr>
<tr class="even">
<td align="center">AO</td>
<td align="center">2pr</td>
<td align="center">28-nAA</td>
</tr>
<tr class="odd">
<td align="center">BO</td>
<td align="center">2qr</td>
<td align="center">24-nBB</td>
</tr>
<tr class="even">
<td align="center">AB</td>
<td align="center">2pq</td>
<td align="center">70</td>
</tr>
<tr class="odd">
<td align="center"></td>
<td align="center">1</td>
<td align="center">163</td>
</tr>
</tbody>
</table>
<p><span class="math display">\[\begin{eqnarray}
&amp; \hat{r^2}=n_{OO}/n=41/163\doteq 0.2515\, \Rightarrow \hat{r}=0.50\\
&amp; 2\hat{p}\hat{q}=n_{AB}/n=70/163\doteq 0.4294\, \Rightarrow \hat{p}\hat{q}=0.215\\
&amp; \hat{p^2}+2\hat{p}\hat{r}=28/163\, \Rightarrow\hat{p^2}+\hat{p}=28/163\tag{1}\\ 
&amp; \hat{q^2}+2\hat{q}\hat{r}=24/163\, \Rightarrow\hat{q^2}+\hat{q}=24/163\tag{2}\\
&amp; \text{we have}\quad  p+q+r=1\Rightarrow \hat{p}+\hat{q}=1\\
&amp; \text{(2)}\, \Rightarrow \hat{p^2}-2\hat{p}=24/163-3/4\tag{3}\\
&amp; \text{combine (1) and (3)}\quad \Rightarrow 3\hat{p^2}=80/163-3/4\\
\end{eqnarray}\]</span></p>
<p>Record the maximum likelihood values in M-steps,they are increasing.</p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb114-1" title="1">nA. &lt;-<span class="st"> </span><span class="dv">28</span>; nB. &lt;-<span class="st"> </span><span class="dv">24</span>; nOO &lt;-<span class="st"> </span><span class="dv">41</span>; nAB &lt;-<span class="st"> </span><span class="dv">70</span></a>
<a class="sourceLine" id="cb114-2" title="2">p &lt;-<span class="st"> </span>q &lt;-<span class="st"> </span>r &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">100</span>)</a>
<a class="sourceLine" id="cb114-3" title="3">p[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb114-4" title="4">q[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="fl">0.2</span></a>
<a class="sourceLine" id="cb114-5" title="5">r[<span class="dv">1</span>] &lt;-<span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="st"> </span>p[<span class="dv">1</span>]<span class="op">-</span><span class="st"> </span>q[<span class="dv">1</span>])</a>
<a class="sourceLine" id="cb114-6" title="6"></a>
<a class="sourceLine" id="cb114-7" title="7">f &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) {</a>
<a class="sourceLine" id="cb114-8" title="8">  <span class="kw">return</span>((nB.<span class="op">*</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a)<span class="op">+</span>nB.<span class="op">+</span>nAB)<span class="op">/</span>(nA.<span class="op">*</span>a<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>a<span class="dv">-2</span><span class="op">*</span>b)<span class="op">+</span>nA.<span class="op">+</span>nAB))</a>
<a class="sourceLine" id="cb114-9" title="9">}</a>
<a class="sourceLine" id="cb114-10" title="10">g &lt;-<span class="st"> </span><span class="cf">function</span>(a,b) {</a>
<a class="sourceLine" id="cb114-11" title="11">((<span class="dv">1</span><span class="op">-</span>a<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>a<span class="dv">-2</span><span class="op">*</span>b))<span class="op">*</span>nA.<span class="op">+</span>(<span class="dv">1</span><span class="op">-</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a))<span class="op">*</span>nB.<span class="op">+</span><span class="dv">2</span><span class="op">*</span>nOO)<span class="op">/</span>((nB.<span class="op">*</span>b<span class="op">/</span>(<span class="dv">2</span><span class="op">-</span>b<span class="dv">-2</span><span class="op">*</span>a)<span class="op">+</span>nB.<span class="op">+</span>nAB))</a>
<a class="sourceLine" id="cb114-12" title="12">}</a>
<a class="sourceLine" id="cb114-13" title="13">threshold &lt;-<span class="st"> </span><span class="fl">1e-5</span></a>
<a class="sourceLine" id="cb114-14" title="14"></a>
<a class="sourceLine" id="cb114-15" title="15"><span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span><span class="dv">100</span>) {</a>
<a class="sourceLine" id="cb114-16" title="16">   p[k] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">g</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb114-17" title="17">   q[k] &lt;-<span class="st"> </span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">f</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])<span class="op">*</span>(<span class="dv">1</span><span class="op">+</span><span class="kw">g</span>(p[k<span class="dv">-1</span>],q[k<span class="dv">-1</span>])))</a>
<a class="sourceLine" id="cb114-18" title="18">   r[k] &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span><span class="st"> </span>p[k] <span class="op">-</span><span class="st"> </span>q[k]</a>
<a class="sourceLine" id="cb114-19" title="19">   <span class="cf">if</span>((p[k]<span class="op">-</span>p[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold) <span class="op">&amp;</span><span class="st"> </span>(q[k]<span class="op">-</span>q[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold) <span class="op">&amp;</span>(r[k]<span class="op">-</span>r[k<span class="dv">-1</span>] <span class="op">&lt;=</span><span class="st"> </span>threshold))</a>
<a class="sourceLine" id="cb114-20" title="20">   {<span class="kw">print</span>(<span class="kw">c</span>(k, p[k], q[k],r[k]))</a>
<a class="sourceLine" id="cb114-21" title="21">       <span class="cf">break</span></a>
<a class="sourceLine" id="cb114-22" title="22">    }</a>
<a class="sourceLine" id="cb114-23" title="23">}</a></code></pre></div>
<pre><code>## [1] 7.0000000 0.3273433 0.3104259 0.3622308</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb116-1" title="1">x &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dv">1</span>,k,<span class="dv">1</span>)</a>
<a class="sourceLine" id="cb116-2" title="2"><span class="kw">plot</span>(x, p[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;green&quot;</span>,<span class="dt">ylim=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.7</span>), <span class="dt">main =</span> <span class="st">&quot;The log-maximum likelihood values in M-steps&quot;</span> , <span class="dt">xlab =</span> <span class="st">&quot;The number of iteration&quot;</span>, <span class="dt">ylab =</span> <span class="st">&quot;The value of iteration&quot;</span>)</a>
<a class="sourceLine" id="cb116-3" title="3"><span class="kw">lines</span>(x, q[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;yellow&quot;</span>)</a>
<a class="sourceLine" id="cb116-4" title="4"><span class="kw">lines</span>(x, r[<span class="dv">1</span><span class="op">:</span>k], <span class="st">&quot;b&quot;</span>, <span class="dt">col =</span> <span class="st">&quot;red&quot;</span>)</a>
<a class="sourceLine" id="cb116-5" title="5"><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&quot;p&quot;</span>, <span class="st">&quot;q&quot;</span>, <span class="st">&quot;r&quot;</span>),<span class="dt">lty =</span> <span class="dv">1</span>, <span class="dt">col =</span> <span class="kw">c</span>(<span class="st">&quot;green&quot;</span>, <span class="st">&quot;yellow&quot;</span>, <span class="st">&quot;red&quot;</span>))</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="hw920191213" class="section level1">
<h1>HW9(2019/12/13)</h1>
<div id="exercise-3p204" class="section level2">
<h2>Exercise 3(P204)</h2>
<p>Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list: ## Answer</p>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb117-1" title="1">formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</a>
<a class="sourceLine" id="cb117-2" title="2">mpg <span class="op">~</span><span class="st"> </span>disp,</a>
<a class="sourceLine" id="cb117-3" title="3">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</a>
<a class="sourceLine" id="cb117-4" title="4">mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</a>
<a class="sourceLine" id="cb117-5" title="5">mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</a>
<a class="sourceLine" id="cb117-6" title="6">)</a>
<a class="sourceLine" id="cb117-7" title="7"><span class="co"># lapply</span></a>
<a class="sourceLine" id="cb117-8" title="8">la1 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, lm, <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb117-9" title="9">la2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas, <span class="cf">function</span>(x) <span class="kw">lm</span>(<span class="dt">formula =</span> x, <span class="dt">data =</span> mtcars))</a>
<a class="sourceLine" id="cb117-10" title="10"><span class="co"># for loop</span></a>
<a class="sourceLine" id="cb117-11" title="11">lf1 &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(formulas))</a>
<a class="sourceLine" id="cb117-12" title="12"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(formulas)){</a>
<a class="sourceLine" id="cb117-13" title="13">lf1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(formulas[[i]], <span class="dt">data =</span> mtcars)</a>
<a class="sourceLine" id="cb117-14" title="14">}</a></code></pre></div>
<p>Note that all versions return the same content, but they won’t be identical, since the values of the “call” element will differ between each version.</p>
</div>
<div id="exercise-4p204" class="section level2">
<h2>Exercise 4(P204)</h2>
<p>Fit the model mpg ~ disp to each of the bootstrap replicates of mtcars in the list below by using a for loop and lapply() . Can you do it without an anonymous function? ## Answer</p>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb118-1" title="1">bootstraps &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="cf">function</span>(i) {</a>
<a class="sourceLine" id="cb118-2" title="2">rows &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(mtcars), <span class="dt">rep =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb118-3" title="3">mtcars[rows, ]</a>
<a class="sourceLine" id="cb118-4" title="4">})</a>
<a class="sourceLine" id="cb118-5" title="5"><span class="co"># lapply without anonymous function</span></a>
<a class="sourceLine" id="cb118-6" title="6">la &lt;-<span class="st"> </span><span class="kw">lapply</span>(bootstraps, lm, <span class="dt">formula =</span> mpg <span class="op">~</span><span class="st"> </span>disp)</a>
<a class="sourceLine" id="cb118-7" title="7"><span class="co"># for loop</span></a>
<a class="sourceLine" id="cb118-8" title="8">lf &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="st">&quot;list&quot;</span>, <span class="kw">length</span>(bootstraps))</a>
<a class="sourceLine" id="cb118-9" title="9"><span class="cf">for</span> (i <span class="cf">in</span> <span class="kw">seq_along</span>(bootstraps)){</a>
<a class="sourceLine" id="cb118-10" title="10">lf[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(mpg <span class="op">~</span><span class="st"> </span>disp, <span class="dt">data =</span> bootstraps[[i]])</a>
<a class="sourceLine" id="cb118-11" title="11">}</a></code></pre></div>
</div>
<div id="exercise-5p204" class="section level2">
<h2>Exercise 5(P204)</h2>
<p>For each model in the previous two exercises, extract using the function below ## Answer For the models in exercise 3:</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb119-1" title="1">rsq &lt;-<span class="st"> </span><span class="cf">function</span>(mod) <span class="kw">summary</span>(mod)<span class="op">$</span>r.squared</a>
<a class="sourceLine" id="cb119-2" title="2"><span class="kw">sapply</span>(la1, rsq)</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb121-1" title="1"><span class="kw">sapply</span>(la2, rsq)</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb123-1" title="1"><span class="kw">sapply</span>(lf1, rsq)</a></code></pre></div>
<pre><code>## [1] 0.7183433 0.8596865 0.7809306 0.8838038</code></pre>
<p>And the models in exercise 4:</p>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb125-1" title="1"><span class="kw">sapply</span>(la, rsq)</a></code></pre></div>
<pre><code>##  [1] 0.7346167 0.8381836 0.7103609 0.7660127 0.6183933 0.6743736 0.7546826
##  [8] 0.7292703 0.6012971 0.5931921</code></pre>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb127-1" title="1"><span class="kw">sapply</span>(lf, rsq)</a></code></pre></div>
<pre><code>##  [1] 0.7346167 0.8381836 0.7103609 0.7660127 0.6183933 0.6743736 0.7546826
##  [8] 0.7292703 0.6012971 0.5931921</code></pre>
</div>
<div id="exercise-3p213" class="section level2">
<h2>Exercise 3(P213)</h2>
<p>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial. ## Answer</p>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb129-1" title="1">trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(</a>
<a class="sourceLine" id="cb129-2" title="2"><span class="dv">100</span>,</a>
<a class="sourceLine" id="cb129-3" title="3"><span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),</a>
<a class="sourceLine" id="cb129-4" title="4"><span class="dt">simplify =</span> <span class="ot">FALSE</span></a>
<a class="sourceLine" id="cb129-5" title="5">)</a>
<a class="sourceLine" id="cb129-6" title="6"><span class="co"># anonymous function:</span></a>
<a class="sourceLine" id="cb129-7" title="7"><span class="kw">sapply</span>(trials, <span class="cf">function</span>(x) x[[<span class="st">&quot;p.value&quot;</span>]])</a></code></pre></div>
<pre><code>##   [1] 0.17705522 0.58311820 0.91791777 0.36122729 0.30638394 0.64369156
##   [7] 0.84603154 0.38098847 0.10898674 0.13560271 0.76855976 0.34648228
##  [13] 0.95410278 0.88484181 0.82864262 0.16711335 0.88559644 0.14657776
##  [19] 0.11373986 0.95514126 0.53033689 0.50656951 0.85020551 0.70355019
##  [25] 0.39850911 0.65733140 0.27622036 0.95231622 0.13610006 0.39056347
##  [31] 0.22442806 0.83451153 0.49842559 0.44890254 0.72635757 0.09213858
##  [37] 0.20857077 0.64703373 0.51352179 1.00000000 0.10867751 0.74240573
##  [43] 0.63389579 0.21020336 0.47126076 0.29745402 0.46640260 0.34226987
##  [49] 0.53443057 0.68326972 0.86466327 0.55362967 0.79624173 0.91960293
##  [55] 0.27985014 0.22217320 0.47377666 0.74611152 0.62819464 0.73819578
##  [61] 0.48557998 0.98332574 0.72370415 0.35899886 0.32160847 0.19065465
##  [67] 0.37053596 0.74286654 0.06084912 0.56056348 0.59866431 0.88772575
##  [73] 0.89599023 0.41924574 0.34881205 0.72051597 0.21314503 0.59514242
##  [79] 0.16347397 0.17842562 0.11420389 0.24949860 0.53305882 0.22086270
##  [85] 0.56669899 0.83623810 0.82674254 0.78596934 0.03205026 0.92974820
##  [91] 0.51374269 0.87576722 0.47102247 0.16543323 0.39897393 0.42002483
##  [97] 1.00000000 0.22699372 0.57344952 0.40106212</code></pre>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb131-1" title="1"><span class="co"># without anonymous function:</span></a>
<a class="sourceLine" id="cb131-2" title="2"><span class="kw">sapply</span>(trials, <span class="st">&quot;[[&quot;</span>, <span class="st">&quot;p.value&quot;</span>)</a></code></pre></div>
<pre><code>##   [1] 0.17705522 0.58311820 0.91791777 0.36122729 0.30638394 0.64369156
##   [7] 0.84603154 0.38098847 0.10898674 0.13560271 0.76855976 0.34648228
##  [13] 0.95410278 0.88484181 0.82864262 0.16711335 0.88559644 0.14657776
##  [19] 0.11373986 0.95514126 0.53033689 0.50656951 0.85020551 0.70355019
##  [25] 0.39850911 0.65733140 0.27622036 0.95231622 0.13610006 0.39056347
##  [31] 0.22442806 0.83451153 0.49842559 0.44890254 0.72635757 0.09213858
##  [37] 0.20857077 0.64703373 0.51352179 1.00000000 0.10867751 0.74240573
##  [43] 0.63389579 0.21020336 0.47126076 0.29745402 0.46640260 0.34226987
##  [49] 0.53443057 0.68326972 0.86466327 0.55362967 0.79624173 0.91960293
##  [55] 0.27985014 0.22217320 0.47377666 0.74611152 0.62819464 0.73819578
##  [61] 0.48557998 0.98332574 0.72370415 0.35899886 0.32160847 0.19065465
##  [67] 0.37053596 0.74286654 0.06084912 0.56056348 0.59866431 0.88772575
##  [73] 0.89599023 0.41924574 0.34881205 0.72051597 0.21314503 0.59514242
##  [79] 0.16347397 0.17842562 0.11420389 0.24949860 0.53305882 0.22086270
##  [85] 0.56669899 0.83623810 0.82674254 0.78596934 0.03205026 0.92974820
##  [91] 0.51374269 0.87576722 0.47102247 0.16543323 0.39897393 0.42002483
##  [97] 1.00000000 0.22699372 0.57344952 0.40106212</code></pre>
</div>
<div id="exercise-7p214" class="section level2">
<h2>Exercise 7(P214)</h2>
<p>Implement mcsapply() , a multicore version of sapply() . Can you implement mcvapply() , a parallel version of vapply() ? Why or why not? ## Answer</p>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb133-1" title="1"><span class="kw">library</span>(parallel)</a>
<a class="sourceLine" id="cb133-2" title="2">mcsapply&lt;-<span class="cf">function</span>(x){</a>
<a class="sourceLine" id="cb133-3" title="3">  <span class="kw">unlist</span>(<span class="kw">mclapply</span>(x, sqrt, <span class="dt">mc.cores =</span> <span class="dv">3</span>))</a>
<a class="sourceLine" id="cb133-4" title="4">}</a></code></pre></div>
<p>My computer doesn’t support the operation of function, so I don’t know if the implement of this function is feasible.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
